{"content": "TERM: Class: InsiderConnection\n\nDEFINITION:\nConnection between teams through player/coach movement\n\nBLUEPRINT DETAILS:\nExtracted from /mnt/3626C55326C514B1/Happier/Three_PointO_ArchE/nfl_insider_intelligence.py, type: python_class\n\nFULL IMPLEMENTATION CODE (nfl_insider_intelligence.py):\n```python\n#!/usr/bin/env python3\n\"\"\"\nNFL Insider Intelligence Module\nTracks player/coach movement, insider knowledge, and betting line intelligence\n\nThis module identifies:\n1. Players/coaches who moved between teams (insider knowledge)\n2. Backup QBs who know the opponent's system\n3. Practice squad players with system familiarity\n4. Betting line shading (public vs sharp money)\n5. Travel/venue factors affecting lines\n\"\"\"\n\nimport logging\nfrom typing import Dict, Any, List, Optional, Tuple\nfrom dataclasses import dataclass, field\nfrom datetime import datetime, timedelta\nimport re\n\nlogger = logging.getLogger(__name__)\n\n@dataclass\nclass InsiderConnection:\n    \"\"\"Connection between teams through player/coach movement\"\"\"\n    person_name: str\n    role: str  # \"player\", \"coach\", \"practice_squad\", \"backup_qb\"\n    from_team: str\n    to_team: str\n    years_with_team: int\n    knowledge_level: str  # \"high\", \"medium\", \"low\"\n    specific_knowledge: List[str]  # e.g., [\"play calls\", \"hand signals\", \"system\"]\n    impact_level: str  # \"critical\", \"significant\", \"moderate\", \"minimal\"\n    current_status: str  # \"active\", \"inactive\", \"coach\", \"cut\"\n    \n@dataclass\nclass BettingLineIntelligence:\n    \"\"\"Analysis of betting line and public vs sharp money\"\"\"\n    public_line: float  # The published spread\n    sharp_line: float  # The \"real\" line (adjusted for public betting)\n    line_shading: float  # How much the line is shaded (public_line - sharp_line)\n    public_money_percentage: float  # % of bets on favorite\n    sharp_money_percentage: float  # % of sharp money on favorite\n    travel_factor: float  # Points added/subtracted for travel/venue\n    team_popularity_factor: float  # Points added for popular teams (Cowboys, etc.)\n    real_matchup_line: float  # What the line \"should\" be based on talent\n    edge_opportunity: str  # \"fade_public\", \"follow_sharp\", \"neutral\"\n    \n@dataclass\nclass SystemFamiliarity:\n    \"\"\"Analysis of who knows whose system\"\"\"\n    team1_knows_team2_system: List[InsiderConnection]\n    team2_knows_team1_system: List[InsiderConnection]\n    advantage: str  # \"team1\", \"team2\", \"neutral\"\n    confidence: float\n    key_insights: List[str]\n\n\nclass NFLInsiderIntelligence:\n    \"\"\"\n    Tracks insider knowledge and betting line intelligence\n    \"\"\"\n    \n    def __init__(self):\n        # This would be populated from a database of player/coach movements\n        # For now, using example data structure\n        self.insider_connections: List[InsiderConnection] = []\n        self._load_insider_database()\n    \n    def _load_insider_database(self):\n        \"\"\"\n        Load database of player/coach movements between teams\n        This would be populated from:\n        - NFL transaction logs\n        - Team roster changes\n        - Coaching staff changes\n        - Practice squad movements\n        \"\"\"\n        # Example data - would be from real database\n        # In production, this would query:\n        # - NFL.com transactions\n        # - Team websites\n        # - News articles about trades/cuts\n        # - Coaching staff announcements\n        \n        self.insider_connections = [\n            # Example: Backup QB who was on opponent's sideline\n            InsiderConnection(\n                person_name=\"Backup QB Example\",\n                role=\"backup_qb\",\n                from_team=\"Team A\",\n                to_team=\"Team B\",\n                years_with_team=3,\n                knowledge_level=\"high\",\n                specific_knowledge=[\"play calls\", \"hand signals\", \"audible system\", \"red zone plays\"],\n                impact_level=\"significant\",\n                current_status=\"active\"\n            ),\n            # Example: Coach who moved teams\n            InsiderConnection(\n                person_name=\"Offensive Coordinator\",\n                role=\"coach\",\n                from_team=\"Team A\",\n                to_team=\"Team B\",\n                years_with_team=2,\n                knowledge_level=\"critical\",\n                specific_knowledge=[\"entire offensive system\", \"tendencies\", \"personnel packages\"],\n                impact_level=\"critical\",\n                current_status=\"coach\"\n            ),\n            # Example: Practice squad player\n            InsiderConnection(\n                person_name=\"Practice Squad WR\",\n                role=\"practice_squad\",\n                from_team=\"Team A\",\n                to_team=\"Team B\",\n                years_with_team=1,\n                knowledge_level=\"medium\",\n                specific_knowledge=[\"route concepts\", \"timing\"],\n                impact_level=\"moderate\",\n                current_status=\"cut\"\n            )\n        ]\n    \n    def analyze_insider_connections(self, team1: str, team2: str) -> SystemFamiliarity:\n        \"\"\"\n        Analyze insider connections between two teams\n        \n        Looks for:\n        - Players who were on team1 and now on team2 (or vice versa)\n        - Coaches who moved between teams\n        - Backup QBs who know the system\n        - Practice squad players with knowledge\n        \"\"\"\n        team1_to_team2 = [\n            conn for conn in self.insider_connections\n            if conn.from_team == team1 and conn.to_team == team2\n        ]\n        \n        team2_to_team1 = [\n            conn for conn in self.insider_connections\n            if conn.from_team == team2 and conn.to_team == team1\n        ]\n        \n        # Calculate advantage\n        team1_advantage_score = sum(\n            self._connection_impact_score(conn) for conn in team2_to_team1\n        )\n        team2_advantage_score = sum(\n            self._connection_impact_score(conn) for conn in team1_to_team2\n        )\n        \n        if team1_advantage_score > team2_advantage_score + 2:\n            advantage = \"team1\"\n            confidence = min(0.9, 0.6 + (team1_advantage_score - team2_advantage_score) * 0.1)\n        elif team2_advantage_score > team1_advantage_score + 2:\n            advantage = \"team2\"\n            confidence = min(0.9, 0.6 + (team2_advantage_score - team1_advantage_score) * 0.1)\n        else:\n            advantage = \"neutral\"\n            confidence = 0.5\n        \n        # Generate key insights\n        key_insights = []\n        for conn in team1_to_team2 + team2_to_team1:\n            if conn.impact_level in [\"critical\", \"significant\"]:\n                key_insights.append(\n                    f\"{conn.person_name} ({conn.role}) moved from {conn.from_team} to \"\n                    f\"{conn.to_team} with {conn.knowledge_level} knowledge of \"\n                    f\"{', '.join(conn.specific_knowledge)}\"\n                )\n        \n        return SystemFamiliarity(\n            team1_knows_team2_system=team1_to_team2,\n            team2_knows_team1_system=team2_to_team1,\n            advantage=advantage,\n            confidence=confidence,\n            key_insights=key_insights\n        )\n    \n    def _connection_impact_score(self, conn: InsiderConnection) -> float:\n        \"\"\"Calculate impact score for an insider connection\"\"\"\n        base_scores = {\n            \"critical\": 5.0,\n            \"significant\": 3.0,\n            \"moderate\": 1.5,\n            \"minimal\": 0.5\n        }\n        \n        knowledge_multipliers = {\n            \"high\": 1.5,\n            \"medium\": 1.0,\n            \"low\": 0.5\n        }\n        \n        role_multipliers = {\n            \"coach\": 2.0,  # Coaches have most knowledge\n            \"backup_qb\": 1.5,  # Backup QBs know the system\n            \"player\": 1.0,\n            \"practice_squad\": 0.7\n        }\n        \n        base = base_scores.get(conn.impact_level, 1.0)\n        knowledge = knowledge_multipliers.get(conn.knowledge_level, 1.0)\n        role = role_multipliers.get(conn.role, 1.0)\n        \n        return base * knowledge * role\n    \n    def analyze_betting_line(self, team1: str, team2: str, public_line: float,\n                            favorite: str, venue: str = \"neutral\") -> BettingLineIntelligence:\n        \"\"\"\n        Analyze betting line for shading and edge opportunities\n        \n        Key factors:\n        1. Public money (moves line toward popular teams)\n        2. Travel factor (road teams get extra points)\n        3. Team popularity (Cowboys, Packers, etc. get shaded)\n        4. Sharp money (professional bettors)\n        \"\"\"\n        # Popular teams that get extra shading\n        popular_teams = {\n            \"Dallas Cowboys\": 1.5,\n            \"Green Bay Packers\": 1.0,\n            \"Pittsburgh Steelers\": 1.0,\n            \"New England Patriots\": 0.5,\n            \"Kansas City Chiefs\": 0.5\n        }\n        \n        # Travel factors (road teams typically get 2-3 points)\n        travel_factor = 2.5 if venue != \"home\" else 0.0\n        \n        # Team popularity shading\n        team1_popularity = popular_teams.get(team1, 0.0)\n        team2_popularity = popular_teams.get(team2, 0.0)\n        \n        # If favorite is popular team, line is shaded in their favor\n        if favorite == team1:\n            popularity_shading = team1_popularity\n        elif favorite == team2:\n            popularity_shading = team2_popularity\n        else:\n            popularity_shading = 0.0\n        \n        # Calculate \"real\" line (remove shading)\n        # Public typically bets 60-70% on favorite\n        public_money_pct = 0.65  # Would be from real betting data\n        \n        # Sharp money typically fades public (bets against public)\n        sharp_money_pct = 1.0 - public_money_pct\n        \n        # Line shading = how much the line moved due to public betting\n        total_shading = travel_factor + popularity_shading\n        \n        # Real matchup line (what it should be based on talent)\n        sharp_line = public_line - total_shading\n        \n        # Determine edge opportunity\n        if sharp_money_pct > 0.6:\n            edge = \"follow_sharp\"  # Sharp money is heavy on one side\n        elif public_money_pct > 0.7:\n            edge = \"fade_public\"  # Public is too heavy, fade them\n        else:\n            edge = \"neutral\"\n        \n        return BettingLineIntelligence(\n            public_line=public_line,\n            sharp_line=sharp_line,\n            line_shading=total_shading,\n            public_money_percentage=public_money_pct,\n            sharp_money_percentage=sharp_money_pct,\n            travel_factor=travel_factor,\n            team_popularity_factor=popularity_shading,\n            real_matchup_line=sharp_line,\n            edge_opportunity=edge\n        )\n    \n    def search_insider_connections(self, team1: str, team2: str) -> List[InsiderConnection]:\n        \"\"\"\n        Search for all insider connections between two teams\n        \n        This would search:\n        - NFL transaction database\n        - Team roster history\n        - Coaching staff history\n        - Practice squad rosters\n        - News articles about trades/cuts\n        \"\"\"\n        connections = []\n        \n        # Search for players who moved between teams\n        # (In production, this would query real databases)\n        for conn in self.insider_connections:\n            if (conn.from_team == team1 and conn.to_team == team2) or \\\n               (conn.from_team == team2 and conn.to_team == team1):\n                connections.append(conn)\n        \n        return connections\n    \n    def get_backup_qb_insights(self, team1: str, team2: str) -> List[Dict[str, Any]]:\n        \"\"\"\n        Find backup QBs who were on opponent's sideline\n        \n        These players have intimate knowledge of:\n        - Play calls\n        - Hand signals\n        - Audible system\n        - Red zone tendencies\n        - Two-minute drill plays\n        \"\"\"\n        insights = []\n        \n        for conn in self.insider_connections:\n            if conn.role == \"backup_qb\":\n                if (conn.from_team == team1 and conn.to_team == team2) or \\\n                   (conn.from_team == team2 and conn.to_team == team1):\n                    insights.append({\n                        \"player\": conn.person_name,\n                        \"current_team\": conn.to_team,\n                        \"former_team\": conn.from_team,\n                        \"years_knowledge\": conn.years_with_team,\n                        \"knowledge_areas\": conn.specific_knowledge,\n                        \"impact\": conn.impact_level,\n                        \"insight\": f\"{conn.person_name} spent {conn.years_with_team} years on {conn.from_team}'s \"\n                                  f\"sideline and knows their {', '.join(conn.specific_knowledge)}\"\n                    })\n        \n        return insights\n    \n    def get_coaching_staff_insights(self, team1: str, team2: str) -> List[Dict[str, Any]]:\n        \"\"\"\n        Find coaching staff members who moved between teams\n        \n        These have the most valuable insider knowledge:\n        - Entire offensive/defensive system\n        - Tendencies and play-calling patterns\n        - Personnel preferences\n        - Game planning strategies\n        \"\"\"\n        insights = []\n        \n        for conn in self.insider_connections:\n            if conn.role == \"coach\":\n                if (conn.from_team == team1 and conn.to_team == team2) or \\\n                   (conn.from_team == team2 and conn.to_team == team1):\n                    insights.append({\n                        \"coach\": conn.person_name,\n                        \"current_team\": conn.to_team,\n                        \"former_team\": conn.from_team,\n                        \"years_knowledge\": conn.years_with_team,\n                        \"knowledge_areas\": conn.specific_knowledge,\n                        \"impact\": conn.impact_level,\n                        \"insight\": f\"{conn.person_name} was on {conn.from_team}'s coaching staff for \"\n                                  f\"{conn.years_with_team} years and knows their {', '.join(conn.specific_knowledge)}\"\n                    })\n        \n        return insights\n\n\ndef analyze_insider_intelligence(team1: str, team2: str, public_line: float,\n                                 favorite: str, venue: str = \"neutral\") -> Dict[str, Any]:\n    \"\"\"\n    Comprehensive insider intelligence analysis\n    \n    Returns:\n        - System familiarity analysis\n        - Betting line intelligence\n        - Backup QB insights\n        - Coaching staff insights\n        - Edge opportunities\n    \"\"\"\n    intelligence = NFLInsiderIntelligence()\n    \n    # Analyze insider connections\n    system_familiarity = intelligence.analyze_insider_connections(team1, team2)\n    \n    # Analyze betting line\n    line_intelligence = intelligence.analyze_betting_line(team1, team2, public_line, favorite, venue)\n    \n    # Get specific insights\n    backup_qb_insights = intelligence.get_backup_qb_insights(team1, team2)\n    coaching_insights = intelligence.get_coaching_staff_insights(team1, team2)\n    \n    # Determine edge opportunities\n    edge_opportunities = []\n    \n    if system_familiarity.advantage != \"neutral\":\n        edge_opportunities.append({\n            \"type\": \"insider_knowledge\",\n            \"team\": team1 if system_familiarity.advantage == \"team1\" else team2,\n            \"advantage\": f\"{system_familiarity.advantage} has insider knowledge advantage\",\n            \"confidence\": system_familiarity.confidence,\n            \"insights\": system_familiarity.key_insights\n        })\n    \n    if line_intelligence.edge_opportunity != \"neutral\":\n        edge_opportunities.append({\n            \"type\": \"betting_line\",\n            \"opportunity\": line_intelligence.edge_opportunity,\n            \"public_line\": public_line,\n            \"sharp_line\": line_intelligence.sharp_line,\n            \"shading\": line_intelligence.line_shading,\n            \"recommendation\": f\"Line is shaded by {line_intelligence.line_shading:.1f} points. \"\n                            f\"Real matchup line: {line_intelligence.sharp_line:.1f}\"\n        })\n    \n    return {\n        \"system_familiarity\": {\n            \"advantage\": system_familiarity.advantage,\n            \"confidence\": system_familiarity.confidence,\n            \"team1_knows_team2\": len(system_familiarity.team1_knows_team2_system),\n            \"team2_knows_team1\": len(system_familiarity.team2_knows_team1_system),\n            \"key_insights\": system_familiarity.key_insights\n        },\n        \"betting_line_intelligence\": {\n            \"public_line\": line_intelligence.public_line,\n            \"sharp_line\": line_intelligence.sharp_line,\n            \"line_shading\": line_intelligence.line_shading,\n            \"travel_factor\": line_intelligence.travel_factor,\n            \"popularity_factor\": line_intelligence.team_popularity_factor,\n            \"real_matchup_line\": line_intelligence.real_matchup_line,\n            \"edge_opportunity\": line_intelligence.edge_opportunity,\n            \"public_money_pct\": line_intelligence.public_money_percentage,\n            \"sharp_money_pct\": line_intelligence.sharp_money_percentage\n        },\n        \"backup_qb_insights\": backup_qb_insights,\n        \"coaching_staff_insights\": coaching_insights,\n        \"edge_opportunities\": edge_opportunities\n    }\n\n\n```\n\nEXAMPLE APPLICATION:\nConnection between teams through player/coach movement\n\nCATEGORY: CodeKnowledge\n\nRELATIONSHIPS:\ntype: FromCodebase; source: /mnt/3626C55326C514B1/Happier/Three_PointO_ArchE/nfl_insider_intelligence.py; source_type: python_class"}