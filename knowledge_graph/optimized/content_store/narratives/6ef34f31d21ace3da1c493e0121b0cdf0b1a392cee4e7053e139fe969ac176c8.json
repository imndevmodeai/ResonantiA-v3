{"content": "TERM: Function: setup_logging\n\nDEFINITION:\nFunction: setup_logging\n\nApplies the logging configuration.\n\nParameters: \n\nBLUEPRINT DETAILS:\nExtracted from /mnt/3626C55326C514B1/Happier/Three_PointO_ArchE/logging_config.py, type: python_function\n\nFULL IMPLEMENTATION CODE (logging_config.py):\n```python\n# --- START OF FILE 3.0ArchE/logging_config.py ---\n# ResonantiA Protocol v3.0 - logging_config.py\n# Configures the Python standard logging framework for Arche.\n# Reads settings from config.py for levels, file paths, and formats.\n\nimport logging\nimport logging.config\nimport os\n# Use relative imports for configuration\ntry:\n    from . import config\nexcept ImportError:\n    # Fallback config if running standalone or package structure differs\n    class FallbackConfig: LOG_LEVEL=logging.INFO; LOG_FILE='logs/arche_fallback_log.log'; LOG_DIR='logs'; LOG_FORMAT='%(asctime)s - %(name)s - %(levelname)s - %(message)s'; LOG_DETAILED_FORMAT='%(asctime)s - %(name)s:%(lineno)d - %(levelname)s - %(module)s - %(message)s'; LOG_MAX_BYTES=10*1024*1024; LOG_BACKUP_COUNT=3\n    config = FallbackConfig(); logging.warning(\"config.py not found for logging_config, using fallback configuration.\")\n\n# --- Logging Configuration Dictionary ---\n# Reads settings from the main config module\n\nLOGGING_CONFIG = {\n    \"version\": 1,\n    \"disable_existing_loggers\": False, # Keep existing loggers (e.g., from libraries)\n    \"formatters\": {\n        # Formatter for console output (simpler)\n        \"standard\": {\n            \"format\": getattr(config, 'LOG_FORMAT', '%(asctime)s - %(name)s - %(levelname)s - %(message)s'),\n            \"datefmt\": \"%Y-%m-%d %H:%M:%S\",\n        },\n        # Formatter for file output (more detailed)\n        \"detailed\": {\n            \"format\": getattr(config, 'LOG_DETAILED_FORMAT', '%(asctime)s - %(name)s:%(lineno)d - %(levelname)s - %(module)s - %(message)s'),\n            \"datefmt\": \"%Y-%m-%d %H:%M:%S\",\n        },\n    },\n    \"handlers\": {\n        # Console Handler (outputs to stderr by default)\n        \"console\": {\n            \"level\": getattr(config, 'LOG_LEVEL', logging.INFO), # Use level from config\n            \"formatter\": \"standard\",\n            \"class\": \"logging.StreamHandler\",\n            \"stream\": \"ext://sys.stderr\", # Explicitly direct to stderr\n        },\n        # Rotating File Handler (writes to log file, rotates when size limit reached)\n        \"file\": {\n            \"level\": getattr(config, 'LOG_LEVEL', logging.INFO), # Use level from config\n            \"formatter\": \"detailed\",\n            \"class\": \"logging.handlers.RotatingFileHandler\",\n            \"filename\": getattr(config, 'LOG_FILE', 'logs/arche_v3_default.log'), # Log file path from config\n            \"maxBytes\": getattr(config, 'LOG_MAX_BYTES', 15*1024*1024), # Max size from config (15MB default)\n            \"backupCount\": getattr(config, 'LOG_BACKUP_COUNT', 5), # Number of backups from config\n            \"encoding\": \"utf-8\",\n        },\n    },\n    \"loggers\": {\n        # Root logger configuration\n        \"root\": {\n            \"level\": getattr(config, 'LOG_LEVEL', logging.INFO), # Root level from config\n            \"handlers\": [\"console\", \"file\"], # Apply both handlers to the root logger\n            # \"propagate\": True # Propagate messages to ancestor loggers (usually not needed for root)\n        },\n        # Example: Quieter logging for noisy libraries if needed\n        # \"noisy_library_name\": {\n        #     \"level\": logging.WARNING, # Set higher level for specific libraries\n        #     \"handlers\": [\"console\", \"file\"],\n        #     \"propagate\": False # Prevent messages from reaching root logger\n        # },\n        \"openai\": { # Example: Quieter logging for OpenAI library specifically\n            \"level\": logging.WARNING,\n            \"handlers\": [\"console\", \"file\"],\n            \"propagate\": False\n        },\n         \"google\": { # Example: Quieter logging for Google library specifically\n            \"level\": logging.WARNING,\n            \"handlers\": [\"console\", \"file\"],\n            \"propagate\": False\n        },\n         \"urllib3\": { # Often noisy with connection pool messages\n            \"level\": logging.WARNING,\n            \"handlers\": [\"console\", \"file\"],\n            \"propagate\": False\n        }\n    }\n}\n\ndef setup_logging():\n    \"\"\"Applies the logging configuration.\"\"\"\n    try:\n        # Ensure the log directory exists before configuring file handler\n        log_dir = getattr(config, 'LOG_DIR', 'logs')\n        if log_dir: # Check if log_dir is configured and not empty\n            os.makedirs(log_dir, exist_ok=True)\n        else:\n            # Handle case where LOG_DIR might be None or empty in config\n            # Default to creating 'logs' in the current directory or handle as error\n            default_log_dir = 'logs'\n            print(f\"Warning: LOG_DIR not configured or empty in config.py. Attempting to use default '{default_log_dir}'.\")\n            os.makedirs(default_log_dir, exist_ok=True)\n            # Update the filename in the config dict if LOG_DIR was missing\n            if 'filename' in LOGGING_CONFIG['handlers']['file']:\n                log_filename = os.path.basename(LOGGING_CONFIG['handlers']['file']['filename'])\n                LOGGING_CONFIG['handlers']['file']['filename'] = os.path.join(default_log_dir, log_filename)\n\n        # Apply the configuration dictionary\n        logging.config.dictConfig(LOGGING_CONFIG)\n        logging.info(\"--- Logging configured successfully (ResonantiA v3.0) ---\")\n        logging.info(f\"Log Level: {logging.getLevelName(getattr(config, 'LOG_LEVEL', logging.INFO))}\")\n        logging.info(f\"Log File: {LOGGING_CONFIG['handlers']['file']['filename']}\")\n    except Exception as e:\n        # Fallback to basic config if dictionary config fails\n        logging.basicConfig(level=logging.WARNING) # Use WARNING to avoid flooding console\n        logging.critical(f\"CRITICAL: Failed to configure logging using dictConfig: {e}. Falling back to basic config.\", exc_info=True)\n\n# --- END OF FILE 3.0ArchE/logging_config.py --- \n```\n\nEXAMPLE APPLICATION:\nFunction: setup_logging\n\nApplies the logging configuration.\n\nParameters: \n\nCATEGORY: CodeKnowledge\n\nRELATIONSHIPS:\ntype: FromCodebase; source: /mnt/3626C55326C514B1/Happier/Three_PointO_ArchE/logging_config.py; source_type: python_function"}