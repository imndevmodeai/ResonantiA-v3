<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Connection Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { margin: 10px 0; }
        .connected { color: green; }
        .disconnected { color: red; }
        .messages { 
            height: 300px; 
            overflow-y: auto; 
            border: 1px solid #ccc; 
            padding: 10px; 
            background: #f9f9f9;
            margin: 10px 0;
        }
        button { 
            padding: 10px 20px; 
            margin: 5px; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer;
        }
        .connect { background: #10b981; color: white; }
        .disconnect { background: #ef4444; color: white; }
        .send { background: #3b82f6; color: white; }
    </style>
</head>
<body>
    <h1>WebSocket Connection Test</h1>
    
    <div class="status">
        <span id="status-indicator" class="disconnected">‚óè</span>
        <span id="status-text">Disconnected</span>
    </div>
    
    <div>
        <button id="connect-btn" class="connect" onclick="connect()">Connect</button>
        <button id="disconnect-btn" class="disconnect" onclick="disconnect()" disabled>Disconnect</button>
        <button id="send-btn" class="send" onclick="sendMessage()" disabled>Send Test Message</button>
    </div>
    
    <div id="messages" class="messages"></div>
    
    <script>
        let ws = null;
        const statusIndicator = document.getElementById('status-indicator');
        const statusText = document.getElementById('status-text');
        const messages = document.getElementById('messages');
        const connectBtn = document.getElementById('connect-btn');
        const disconnectBtn = document.getElementById('disconnect-btn');
        const sendBtn = document.getElementById('send-btn');
        
        function addMessage(message, type = 'info') {
            const div = document.createElement('div');
            div.style.margin = '5px 0';
            div.style.padding = '5px';
            div.style.borderRadius = '3px';
            div.style.fontSize = '14px';
            
            if (type === 'error') {
                div.style.background = '#fee2e2';
                div.style.color = '#dc2626';
            } else if (type === 'success') {
                div.style.background = '#dcfce7';
                div.style.color = '#166534';
            } else {
                div.style.background = '#f3f4f6';
                div.style.color = '#374151';
            }
            
            div.textContent = message;
            messages.appendChild(div);
            messages.scrollTop = messages.scrollHeight;
        }
        
        function updateStatus(connected) {
            if (connected) {
                statusIndicator.className = 'connected';
                statusText.textContent = 'Connected';
                connectBtn.disabled = true;
                disconnectBtn.disabled = false;
                sendBtn.disabled = false;
            } else {
                statusIndicator.className = 'disconnected';
                statusText.textContent = 'Disconnected';
                connectBtn.disabled = false;
                disconnectBtn.disabled = true;
                sendBtn.disabled = true;
            }
        }
        
        function connect() {
            addMessage('üîó Attempting to connect to ws://localhost:8765...');
            
            try {
                ws = new WebSocket('ws://localhost:8765');
                
                ws.onopen = function() {
                    addMessage('‚úÖ WebSocket connected successfully!', 'success');
                    updateStatus(true);
                };
                
                ws.onmessage = function(event) {
                    addMessage('üì® Received: ' + event.data.substring(0, 100) + '...', 'success');
                };
                
                ws.onclose = function(event) {
                    addMessage('‚ùå WebSocket connection closed. Code: ' + event.code + ', Reason: ' + event.reason);
                    updateStatus(false);
                };
                
                ws.onerror = function(error) {
                    addMessage('üö® WebSocket error: ' + error, 'error');
                    updateStatus(false);
                };
                
            } catch (error) {
                addMessage('‚ùå Failed to create WebSocket: ' + error, 'error');
                updateStatus(false);
            }
        }
        
        function disconnect() {
            if (ws) {
                ws.close();
                ws = null;
            }
        }
        
        function sendMessage() {
            if (ws && ws.readyState === WebSocket.OPEN) {
                const message = 'Test message from browser at ' + new Date().toLocaleTimeString();
                ws.send(message);
                addMessage('üì§ Sent: ' + message);
            } else {
                addMessage('‚ùå WebSocket is not connected', 'error');
            }
        }
        
        // Auto-connect on page load
        window.onload = function() {
            addMessage('üöÄ Page loaded, ready to test WebSocket connection');
        };
    </script>
</body>
</html>









